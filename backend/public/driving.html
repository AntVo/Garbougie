<html>
    <head>
        <link rel="stylesheet" type="text/css" href="../sdk/map.css"/>
        <script src="../sdk/tomtom.min.js"></script>
    </head>
    <body style="width: 100%; height: 100%; margin: 0; padding: 0;">
        <div id="map" style="width: 100%; height: 100%;"></div>
        <script>
            tomtom.routingKey('KAZtgZxAjZAyOApEYJdAjHaEqsQQ7tJn');
            tomtom.searchKey('KAZtgZxAjZAyOApEYJdAjHaEqsQQ7tJn');
            tomtom.key("KAZtgZxAjZAyOApEYJdAjHaEqsQQ7tJn");
            var map = tomtom.map("map", {source: "vector", basePath: "/backend/sdk"});
            var routeOnMap = tomtom.routeOnMap({
                    serviceOptions: {
                        maxAlternatives: 0,
                        traffic: true
                    }
                })
                .addTo(map);
            map.zoomControl.setPosition('topright');

            function redrawMap() {
                if(navigator.geolocation) {
                    navigator.geolocation.watchPosition( success, fail );
                } else {
                    alert("Sorry, your browser does not support geolocation services.");
                }
            }

            function success(position)
            {
                //TODO: Get following destination
                
                routeOnMap.clear();
                routeOnMap.draw([{lat: position.coords.latitude, lng: position.coords.longitude}, {lat: 37.489433, lng: -122.2427396}]);
            }

            function fail() {
                // fail
            }

            redrawMap();

            setInterval(redrawMap, 10000);
        </script>
    </body>
</html>